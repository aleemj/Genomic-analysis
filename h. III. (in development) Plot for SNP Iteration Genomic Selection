library(ggplot2)
# Set directory for GS results
setwd("/Users/adrianlee/Documents/NUS/Writing/WRITING_Adrian et al 2023_Arugula reference genonme paper/Genomic analysis/5. GS/leaf_area_GS/SNP_iteration")
# List all .RData files in the directory
result_files <- list.files(pattern = "\\.RData$")
# Initialize an empty dataframe to store results
results_df <- data.frame()
# Iterate over each file
for (filename in result_files) {
  # Load the data from the .RData file
  load(filename)
  # Extract the number of SNPs and accuracy from the loaded object
  num_snps <- as.numeric(sub(".*_(\\d+)_SNPs\\.RData", "\\1", filename))
  colnames(outCOR)[1] <- "Accuracy"
  temp_df <- data.frame(SNPs = num_snps, Accuracy = outCOR)
  # Append to results_df
  results_df <- rbind(results_df, temp_df)
}
# Create a row for 0 SNPs with 0 Accuracy
zero_row <- data.frame(SNPs = 0, Accuracy = 0)
# Append the zero_row to results_df
results_df <- rbind(results_df, zero_row)
results_df$SNPs <- as.numeric(results_df$SNPs)
# Plot results
ggplot(results_df, aes(x =SNPs, y = Accuracy, group = SNPs)) +
  geom_boxplot() +
  labs(x = "Number of SNPs", y = "Accuracy", title = "GS model comparison of leaf area prediction accuracy across SNP sets") +
  theme_classic() +
  theme(
    axis.ticks = element_line(),
    axis.title.x = element_text(),
    axis.title.y = element_text(),
    axis.text.x = element_text(),
    axis.text.y = element_text()
  ) + scale_x_continuous(breaks = seq(min(results_df$SNPs), max(results_df$SNPs), by = 1000)) +
  ylim(0, 1)  # Set the y-axis limits from 0 to 1 (adjust as needed)

